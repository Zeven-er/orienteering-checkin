# 定向越野队训练打卡系统

一个简约而功能完整的定向越野队训练打卡网站，采用绿色主题设计，符合定向越野运动的户外风格。

## 功能特点

### 用户功能
- **姓名登录**：用户可以使用用户名和密码登录系统
- **每日打卡**：用户可以进行训练打卡，记录训练地点和内容
- **记录查看**：用户可以查看自己的历史打卡记录
- **防重复打卡**：系统会自动检测，防止同一天重复打卡

### 管理员功能
- **管理员登录**：管理员账户拥有更高权限
- **发布打卡事项**：管理员可以创建训练打卡事项，设置标题、描述和日期
- **事项管理**：可以查看和管理已发布的打卡事项
- **数据查看**：可以查看所有用户的打卡数据
- **数据筛选**：支持按用户、日期范围筛选数据
- **数据编辑**：管理员可以修改任何打卡记录
- **数据删除**：管理员可以删除错误的打卡记录
- **用户管理**：管理员可以添加新用户，设置用户名和默认密码123456
- **数据导出**：支持按矩阵格式导出数据，第一列为用户名，第一行为打卡事项和日期

## 技术架构

- **前端**：HTML5 + CSS3 + JavaScript
- **后端**：Node.js + Express
- **数据库**：SQLite
- **样式**：响应式设计，绿色主题

## 安装和启动

### 1. 安装依赖
```bash
npm install
```

### 2. 启动服务器
```bash
npm start
```

### 3. 访问系统
打开浏览器访问：http://localhost:3000

## 使用说明

### 测试账号

#### 普通用户
- 用户名：测试用户
- 密码：123456

#### 管理员
- 用户名：管理员
- 密码：admin123

### 用户操作
1. 使用管理员提供的用户名和默认密码123456登录
2. 在打卡页面查看管理员发布的当日训练事项
3. 点击对应事项后的"立即打卡"按钮完成打卡
4. 可添加备注信息
5. 查看下方的个人打卡记录

### 管理员操作
1. 使用管理员账号登录
2. 在"发布打卡事项"标签页中：
   - 创建新的训练打卡事项，设置标题、描述和日期
   - 查看和管理已发布的打卡事项
   - 删除不需要的事项
3. 在"打卡数据管理"标签页中：
   - 使用筛选功能查看特定用户或日期范围的数据
   - 点击"编辑"修改打卡记录
   - 点击"删除"删除打卡记录
   - 点击"导出"将数据导出为CSV文件（矩阵格式）
4. 在"用户管理"标签页中：
   - 添加新用户，用户名自定义，密码自动设为123456
   - 查看用户列表

## 界面设计

- **主题色**：绿色系，符合定向越野的户外风格
- **布局**：简约清晰，易于操作
- **响应式**：支持手机、平板、电脑等不同设备
- **图标**：使用Font Awesome图标增强视觉效果

## 数据库结构

### 用户表 (users)
- id: 用户ID（主键）
- name: 用户名（唯一）
- password: 密码
- is_admin: 是否为管理员
- created_at: 创建时间

### 打卡事项表 (tasks)
- id: 事项ID（主键）
- title: 事项标题
- description: 事项描述
- task_date: 事项日期
- created_at: 创建时间

### 打卡记录表 (checkins)
- id: 记录ID（主键）
- user_id: 用户ID（外键）
- task_id: 事项ID（外键）
- checkin_date: 打卡日期
- checkin_time: 打卡时间
- status: 打卡状态（默认为"已完成"）
- notes: 备注信息
- created_at: 创建时间

## 开发说明

### 文件结构
```
├── server.js          # Express服务器
├── database.js        # 数据库初始化
├── package.json       # 项目配置
├── public/            # 前端文件
│   ├── index.html     # 主页面
│   ├── styles.css     # 样式文件
│   └── script.js      # JavaScript逻辑
└── orienteering.db    # SQLite数据库（自动生成）
```

### API接口

#### 用户相关
- POST /api/login - 用户登录
- POST /api/users - 添加新用户（管理员）
- GET /api/users - 获取用户列表（管理员）

#### 打卡事项相关
- POST /api/tasks - 创建打卡事项（管理员）
- GET /api/tasks - 获取打卡事项列表
- DELETE /api/tasks/:id - 删除打卡事项（管理员）

#### 打卡相关
- POST /api/checkin - 用户打卡
- GET /api/checkins - 获取打卡数据
- GET /api/checkins/matrix - 获取矩阵格式的打卡统计（管理员）
- PUT /api/checkins/:id - 更新打卡记录（管理员）
- DELETE /api/checkins/:id - 删除打卡记录（管理员）

## 注意事项

1. 系统默认创建了测试用户和管理员账号
2. 密码采用明文存储（生产环境建议使用加密）
3. 数据库文件会自动创建在项目根目录
4. 支持多用户同时使用
5. 打卡记录按日期排序，最新的在最前面

## 故障排除

### 端口占用
如果3000端口被占用，可以在server.js中修改端口号：
```javascript
const PORT = process.env.PORT || 3001;
```

### 数据库问题
如果遇到数据库问题，可以删除orienteering.db文件后重启服务器，系统会自动重新创建数据库。

## 后续改进建议

1. 添加密码加密功能
2. 实现密码修改功能
3. 添加训练计划管理
4. 实现数据统计图表
5. 添加训练照片上传功能
6. 实现邮件通知功能
7. 添加GPS定位功能